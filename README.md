# Coresh #

**Сервис для поиска друзей на базе телеграм-бота. Помогает найти единомышленников задавая вопросы сообществу, а так же отвечая на вопросы и оценивая ответы других пользователей.**

Пользователь получает с паузой в сутки набор карточек для взаимодействия с сообществом, который называется спринтом. С помощью карточек задаются вопросы сообществу, даются ответы на вопросы других юзеров и оцениваются их мысли, что формирует связи для алгоритмов рекомендаций. После прохождения спринта пользователь может посмотреть историю активности лучшего по мнению алгоритма потенциального друга, а так же пользователей для которых он сам стал лучшей парой, если такие есть. При взаимной симпатии - система позволяет обменяться контактами.

Платформа выбирает интересных для пользователя людей с помощью рейтинга соседства. В алгоритме рекомендаций учитывается совместимость по типажу, который определяется на основе опросника пройденного пользоватем после регистрации, лайков мыслей других юзеров, общим подпискам на теги и прочим весам (см. описание алгоритмов ниже). Сервис не учитывает пол, возраст и другие анкетные данные не связанные с качествами личности. Платформа имеет открытый исходный код, средства на содержание и разработку собираются с помощью пожертвований, данные пользователей никак не используются в коммерческих целях.

## Вводная информация ##

##### Основные термины #####

**Пользователь:** человек зарегистрированный в системе. Может так же называться участником и юзером.

**Собеседник:** высшая категория для друга и соседа.

**Соседи:** потенциальные собеседники, которые автоматически добавляются в список соседей в случае совпадения типажа или лайка их карточки. Соседи имеют рейтинг соседства. Пользователи с самым высоким рейтингом соседства после каждого спринта взаимно предлагаются друг-другу стать друзьями. Пользователь может заблокировать.

**Друзья:** собеседники, которые были предложены системой как потенциальные друзья и были взаимно одобрены обеими сторонами. Друзья могут смотреть ленты активности друг-друга, так же им доступны ссылки на их личные аккаунты в Телеграме. 

**Языки:** доступные в сообществе языки. Пользователи могут выбирать языки которыми они владеют. Система автоматически определяет язык карточек и показывает их тем юзерам, которые владеют этими языками. 

**Карточка:** интерфейс позволяющий написать вопрсос и дать ответ на вопросы сообщества, оценить ответы других пользователей, а так же пройти опросник на определение знания языков, типажа, интересов пользователя и пр. Является частью спринта.

**Спринт:** генерируемый алгоритмами рекомендаций персональный набор карточек для пользователя. В конце каждого спринта пользователю предлагаются новые друзья - собеседник имеющий самый высокий рейтинг соседства и юзеры, если они имеются, для которых пользователь сам является соседом с самым высоким рейтингом соседства. После предложеных новых друзей, перед началом нового спринта пользователь должен подождать 24 часа. 

**Типаж:** Типажи созданы как один из коэффициентов для алгоритмов рекомендаций. Они не связаны с какими-то интересами или убеждениями пользователей, но помогают находить более комфортных по общему бэкграунду людей, что особенно полезно для новых пользователей. В базе данных ответы на вопросы в "типажах" представлены в виде булева с семантически важным значением NULL. У вопросов могут быть следующие значения: true/NULL/false, true/false, true/NULL. Что бы попасть в соседи пользователя на основе типажа необходимо по всем вопросам попасть либо в полярное значение (true-true или false-false), либо в true или false и NULL (NULL - не важно). На основе типажей у новых пользователей формируются соседи, карточки которых будут приоритетно показываться. Текущий список вопросов для определения типажей см. [здесь](README-files/semantic-list.md).

**Теги:** интересы, жизненные взгляды, темы для обсуждения и прочее. Пользователь должен указать своё отношение к каждому тегу в процессе прохождения спринта. (их много туду) Ответы на теги являются важным критерием в формировании спринта. Отношение к тегу имеют три градации: "не интересно" - вопросы по тегу не отображаются, "интересуюсь" - низкий приоритет показа карточек, "занимаюсь/поддерживаю/итд" - высокий приоритет показа карточек и повышенный рейтинг соседства для собеседников, которые указали этот же тег. Текущий набор тегов вы можете увидеть [здесь](README-files/semantic-list.md).



**IO/IVO(input, view, output):** описание каждого элемента системы описывается  Каждый логический блок программы описывается следующими
- "I" - Данные которые пользователь запрашивает у сервера прежде чем показать экран. 
- "V" - Формирование экрана и элементы интерфейса взаимодействия с системой. 
- "O" - Обработка пользовательских действий.

##### Веса #####

_Переменные сущностей от значений которых зависит работа алгоритмов_

- **Глобальный рейтинг Пользователя** :  Если у пользователя рейтинг меньше нуля, то он попадает в ад, т.е. он попадает к пользователям с отрицательным рейтингом. Рейтинг ограничен сверху. 
- **Глобальный рейтинг Тега** : Количество вопросов по тегу. 
- **Глобальный рейтинг Вопроса** : Дизслайки (сколько раз пользователи не захотели отвечать на этот вопрос и сколько раз нажали лайк для ответа (и это идет в общий рейтинг пользователя)). 
- **Глобальный рейтинг Ответа** : "Лайки" (идет в общий рейтинг пользователя) 
- **Личный рейтинг Соседства** : Лайки от конкретного пользователя к конкретному пользователю
- **Личный рейтинг Тега** :  ? 
 

## Базовые экраны и классы ##

После запуска бота - система проверяет существует ли пользователь в системе. Если нет - в базу записываются его персованыльные данные и время регистрации, после проверки пользователь перекидывается на главный экран. Если пользователь забанен - выводится сообщение об этом.

#####  Главный экран #####

**I:** Проверяется статус спринта. Если спринт в режиме ожидания - передаётся оставшееся время, до возможности начать новый спринт. 

**S:** На экране расположены 3 кнопки.
- Кнопка "Запустить спринт" (если в режиме ожидания, вместо кнопки показывается сколько осталось времени до возможности начать спринт). Кнопка вызывает базовый класс (роутер) спринта.
- Кнопка "Настройки" - переход в раздел настроек
- Кнопка "Мои Друзья" - переход в раздел друзей

**O:** Модифицируется время последнего запуска бота пользователем.


##### Раздел Друзей #####
**TODO**
##### Раздел Настроек #####
**TODO**

##### Роутер #####

**TODO** привести к стандарту ISO

Весь юзерэкспиренс, за исключением раздела "Друзья" и "Настройки" можно представить как бесконечное круговое движение по карточкам, в рамках которых пользователь получает для чтения какие-то данные, после чего отправляет на сервер для обработки свой ответ или реакцию. 

То есть, мы имеет в базе, в таблице users, float значение, например, 5.10, которое обозначает шаг и подшаг на котором находится в данный момент пользователь. В системе реализован роутинг, где описывается каждый шаг. Контент и поведение для каждой карточки формируется на основе базового класса типа карточки и входных данных из его экземпляра в роутере. 

Например, у некой карточки с базовым классом "оценить ответ" вначале запрашивается самый популярный тег в личном рейтинге тегов пользователя, ищется пользователь с самым высоким рейтингом соседства и выбирается его самая популярная карточка по этому тегу, которую ещё не видел пользователь. После того, как ответ будет оценен - соседу добавляется или вычитается рейтинг соседства, в базе меняется значение в ячейке step и заново запускается базовый класс, который формирует новую карточку по настройкам в роутере.  


## Экраны и алгоритмы карусели ##

_Последовательность шагов указывается в базовом классе роутера описанного выше. Каждый шаг расширяет базовый класс типа его карточки. После завершения каждого шага - в таблице юзера обновляется значение поля stap и класс роутера запускает следующий шаг._

##### Шаги 0.x #####
**TODO**
- Языки
- Типажи
- Теги
- Перезапуск шага, если есть незавершенные для типажа и языка.
- Теги считать за спринт с помощью передачи счётчики с перезапуском шага 5.4.3.2.1 -> выход в роутер 

##### Шаг 1.1 #####

**I:**

**S:**

**O:** 





## Дополнительная информация о проекте

- [UML-карта](README-files/uml.md)
- [Семантическая структура](README-files/semantic-list.md)

## Кураторы проекта

- [t.me/grandcore](https://t.me/grandcore)
- [t.me/Mechislav](https://t.me/Mechislav)
