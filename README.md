# Coresh #

**Сервис для поиска друзей на базе телеграм-бота. Помогает найти единомышленников задавая вопросы сообществу, а так же отвечая на вопросы и оценивая ответы других пользователей.**

Пользователь получает с паузой в сутки набор карточек для взаимодействия с сообществом, который называется спринтом. С помощью карточек задаются вопросы сообществу, даются ответы на вопросы других юзеров и оцениваются их мысли, что формирует связи для алгоритмов рекомендаций. После прохождения спринта пользователь может посмотреть историю активности лучшего по мнению алгоритма потенциального друга, а так же пользователей для которых он сам стал лучшей парой, если такие есть. При взаимной симпатии - система позволяет обменяться контактами.

Платформа выбирает интересных для пользователя людей с помощью рейтинга соседства. В алгоритме рекомендаций учитывается совместимость по типажу, который определяется на основе опросника пройденного пользоватем после регистрации, лайков мыслей других юзеров, общим подпискам на теги и прочим весам (см. описание алгоритмов ниже). Сервис не учитывает пол, возраст и другие анкетные данные не связанные с качествами личности. Платформа имеет открытый исходный код, средства на содержание и разработку собираются с помощью пожертвований, данные пользователей никак не используются в коммерческих целях.

---
## Вводная информация ##
---
### Основные термины ###

**Пользователь:** человек зарегистрированный в системе. Может так же называться участником и юзером.

**Собеседник:** высшая категория для друга и соседа.

**Соседи:** потенциальные собеседники, которые автоматически добавляются в список соседей в случае совпадения типажа или лайка их карточки. Соседи имеют рейтинг соседства. Пользователи с самым высоким рейтингом соседства после каждого спринта взаимно предлагаются друг-другу стать друзьями. Пользователь может заблокировать.

**Друзья:** собеседники, которые были предложены системой как потенциальные друзья и были взаимно одобрены обеими сторонами. Друзья могут смотреть ленты активности друг-друга, так же им доступны ссылки на их личные аккаунты в Телеграме. 

**Языки:** доступные в сообществе языки. Пользователи могут выбирать языки которыми они владеют. Система автоматически определяет язык карточек и показывает их тем юзерам, которые владеют этими языками. 

**Карточка:** интерфейс позволяющий написать вопрсос и дать ответ на вопросы сообщества, оценить ответы других пользователей, а так же, например, пройти опросник на определение знания языков, типажа и интересов пользователя и т.д. Является частью спринта. В таблице юзера текущая карточка хранится в трёх ячейках, которые формируют число типа "1.2.5", где первый блок цифр - группа карточек, второй - номер самой карточки в группе, третий - счётчик показа одной и той же карточки, там где это нужно. Каждая карточка основана на базовом классе, например, "вопрос" и дополнена параметрами для формирования карточки для конкретного шага.   


**Спринт:** генерируемый алгоритмами рекомендаций персональный набор карточек для пользователя. В конце каждого спринта пользователю предлагаются новые друзья - собеседник имеющий самый высокий рейтинг соседства и юзеры, если они имеются, для которых пользователь сам является соседом с самым высоким рейтингом соседства. После предложеных новых друзей, перед началом нового спринта пользователь должен подождать 24 часа. 

**Типаж:** Типажи созданы как один из коэффициентов для алгоритмов рекомендаций. Они не связаны с какими-то интересами или убеждениями пользователей, но помогают находить более комфортных по общему бэкграунду людей, что особенно полезно для новых пользователей. В базе данных ответы на вопросы в "типажах" представлены в виде булева с семантически важным значением NULL. У вопросов могут быть следующие значения: true/NULL/false, true/false, true/NULL. Что бы попасть в соседи пользователя на основе типажа необходимо по всем вопросам попасть либо в полярное значение (true-true или false-false), либо в true или false и NULL (NULL - не важно). На основе типажей у новых пользователей формируются соседи, карточки которых будут приоритетно показываться. Текущий список вопросов для определения типажей см. [здесь](README-files/semantic-list.md).

**Теги:** интересы, жизненные взгляды, темы для обсуждения и прочее. Пользователь должен указать своё отношение к каждому тегу в процессе прохождения спринта. (их много туду) Ответы на теги являются важным критерием в формировании спринта. Отношение к тегу имеют три градации: "не интересно" - вопросы по тегу не отображаются, "интересуюсь" - низкий приоритет показа карточек, "занимаюсь/поддерживаю/итд" - высокий приоритет показа карточек и повышенный рейтинг соседства для собеседников, которые указали этот же тег. Текущий набор тегов вы можете увидеть [здесь](README-files/semantic-list.md).


---
### Веса для алгоритмов ###

_Переменные от значений которых зависит работа алгоритмов_

- **Рейтинг Пользователя** : у каждого юзера есть личный рейтинг. Он существует параллельно с рейтингом вопросов и ответов. Например, пользователь лайкнул чей-то ответ и рейтинг добавится не только карточке, но и собеседнику. Если рейтинг станет отрицательным, пользователь сможет общаться только с другими юзерами, которые так же имеют отрицательный рейтинг. Пользователям с положительным рейтингом так же не доступны карточки собеседников с отрицательным рейтингом.
- **Глобальный рейтинг Тега** : рейтинг тега равен количеству вопросов по нему. 
- **Глобальный рейтинг Вопроса** : увеличивается при ответе на него, а уменьшается, если пользователь указал, вопрос ему не нравится. 
- **Глобальный рейтинг Ответа** : увеличивается - если пользователь лайкнул ответ, уменьшается - если нажал кнопку "далее", или заблокировал автора вопроса.  
- **Личный рейтинг Соседства** : собеседники, которые были добавлены после прохождения теста на определения типажа, а так же юзеры карточки которых пользователь хоть раз лайкнул - добавляются в список соседей и в дальшейшем, лайкая или дислайкая их карточки, изменяется рейтинг соседства.

---
## Базовые экраны и классы ##

---
### Точка входа ###

После запуска бота - система проверяет существует ли пользователь. Если нет - в базу записываются его персованыльные данные и время регистрации, после проверки он перекидывается на главный экран. Если пользователь забанен - выводится сообщение "Вам здесь не рады". Модифицируется время последнего запуска бота пользователем.

---
### Главный экран ###

Проверяется статус спринта. Если спринт в режиме ожидания - передаётся оставшееся время до возможности начать новый спринт. 

На экране расположены 3 кнопки.
- Кнопка "Запустить спринт" - вызывает базовый класс спринт-роутера (если в режиме ожидания, вместо кнопки показывается сколько осталось времени до возможности начать).
- Кнопка "Настройки" - переход в раздел настроек
- Кнопка "Мои Друзья" - переход в раздел друзей

---

### Раздел Друзей ###

TODO

---
### Раздел Настроек ###

TODO

---
### Спринт-Роутер ###

Роутер смотрит в талице пользователя значение его текущего шага спринта и запускает класс типа карточки с необходимымии входными данными для конкретного шага. Каждый шаг спринта описывается ниже. 

---
## Экраны и алгоритмы карусели ##
---
_Последовательность шагов указывается в базовом классе роутера спринта описанного выше. Каждый шаг расширяет базовый класс отсывающий тип карточки. После завершения каждого шага - в таблице юзера обновляется значение поля stap и класс роутера запускает следующий шаг._

---
### Шаги 0.x ###
**TODO**
- Языки
- Типажи
- Теги
---
### Шаг 1.1 ###

TODO

---
### Шаг 1.2 ###

TODO

---
### Шаг 2.1 ###

TODO

---
### Шаг 3.1 ###

TODO

---
### Шаг 4.1 ###

TODO

---
### Шаг 5.1 ###

TODO

---
## Классы-хелперы ##
---
### Изменение значения Степ ###

TODO

---
### Определение языка ###
TODO

---
## Послесловие ##
---
**Дополнительная информация о проекте**

- [UML-карта](README-files/uml.md)
- [Семантическая структура](README-files/semantic-list.md)

**Кураторы проекта**
- [t.me/grandcore](https://t.me/grandcore)
- [t.me/Mechislav](https://t.me/Mechislav)
